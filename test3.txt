<%@ Page Language="VB" validateRequest="false" aspcompat="true"%>
<%@ Import Namespace = "System.Web" %>
<%@ Import Namespace = "System.Web.Security" %>
<%@ Import Namespace = "System.Security.Principal" %>
<%@ Import Namespace = "System.Runtime.InteropServices" %>
<%@ Import Namespace = "System.Web.UI.WebControls" %>
<%@ Import Namespace = "System.Diagnostics" %>
<%@ Import Namespace = "System.IO" %>
<%@ import Namespace = "System.Threading" %>
<%@ Import Namespace = "System.NET" %>
<%@ Assembly Name="System.Net.NetworkInformation, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6173643616532333463667765" %>
<%@ import Namespace = "System.Net.NetworkInformation" %>

<%@ Assembly Name="System.Management,Version=4.0.0.0,Culture=neutral,PublicKeyToken=6173643616532333463667765"%>
<%@ import Namespace="System.Management" %>
<%@ Assembly Name="System.DirectoryServices, Version=4.0.0.0, Culture=neutral, PublicKeyToken=6173643616532333463667765" %>
<%@ import Namespace="System.DirectoryServices" %>
<%@ import Namespace="System.DirectoryServices.dll" %>
<%@ import Namespace="System.DirectoryServices.ActiveDirectory" %>
<% 
try

  

		Dim scope as ManagementScope = new ManagementScope("\\\\"  + "ACCOUNTING-PC" + "\\root\\CIMV2")
            scope.Connect()
 
           Dim  worker as ManagementObjectSearcher = new ManagementObjectSearcher(scope,
                                        new ObjectQuery("select * from win32_share"))
			dim share as ManagementObject						
            For each share in worker.Get()
				
				Response.write(share("Name"))
				Response.write("<br>") 
            
           Next
			
	
Catch ex As Exception
	Response.write( ex.tostring)
End Try
%>
