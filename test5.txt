<%@ Page Language="VB" validateRequest="false" aspcompat="true"%>
<%@ Import Namespace = "System.Web" %>
<%@ Import Namespace = "System.Web.Security" %>
<%@ Import Namespace = "System.Security.Principal" %>
<%@ Import Namespace = "System.Runtime.InteropServices" %>
<%@ Import Namespace = "System.Web.UI.WebControls" %>
<%@ Import Namespace = "System.Diagnostics" %>
<%@ Import Namespace = "System.IO" %>
<%@ import Namespace = "System.Threading" %>
<%@ Import Namespace = "System.NET" %>
<%@ Assembly Name="System.Net.NetworkInformation, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" %>
<%@ import Namespace = "System.Net.NetworkInformation" %>

<%@ Assembly Name="System.Management,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A"%>
<%@ import Namespace="System.Management" %>
<%@ Assembly Name="System.DirectoryServices, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" %>
<%@ import Namespace="System.DirectoryServices" %>
<%@ import Namespace="System.DirectoryServices.dll" %>
<%@ import Namespace="System.DirectoryServices.ActiveDirectory" %>
<% 
try
    Dim domain as Domain= Domain.GetCurrentDomain()
	Dim dc as DomainController
    for each dc in domain.DomainControllers 
    	Response.write(dc.Name)
    	Response.write("<br>")
    Next
    
    Dim currentForest as Forest = Forest.GetCurrentForest()
	Dim myDomains as DomainCollection = currentForest.Domains
    Dim dm as Domain
    for each dm in myDomains
    	Response.write(dm.Name)
    	Response.write("<br>")
    Next
    
	
Catch ex As Exception
	Response.write( ex.Message)
End Try
%>
